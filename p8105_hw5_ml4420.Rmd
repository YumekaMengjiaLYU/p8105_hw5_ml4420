---
title: "p8105_hw5_ml4420"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r cars}

library(tidyverse)

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))



fill_in_missing = function(x) {
 
   #ncols = ncol(x)
  
  # for numeric variables fill in missing values with mean of non-missing values
  if (is.numeric(x)) {
   
    mean_x = mean(x, na.rm = TRUE)
    print(mean_x)
    x=ifelse(is.na(x), mean_x, x)
    
  } 
  
  # for char variables fill in missing values with "virginica"
  else  {
    x=ifelse(is.na(x),"virginica", x) 
   
  }
  
}

output = map_df(.x = iris_with_missing, ~ fill_in_missing(.x))  
```



